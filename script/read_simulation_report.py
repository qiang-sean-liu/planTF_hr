# read simulation report
import pandas as pd

# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_heading10/simulation_closed_loop_nonreactive_agents/2023.08.22.12.48.53/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.08.22.12.48.53.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_headingx10/simulation_closed_loop_nonreactive_agents/2023.08.19.16.05.06/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.08.19.16.05.06.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_multLR_ckpt13/simulation_closed_loop_nonreactive_agents/2023.08.26.01.06.30/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.08.26.01.06.30.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_multilr_iou4_ckpt17/simulation_closed_loop_nonreactive_agents/2023.08.27.05.45.10/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.08.27.05.45.10.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_skipSA_ignoreEgoHist_imiObj_fp16_multLR_ckpt15/simulation_closed_loop_nonreactive_agents/2023.09.03.23.38.11/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.03.23.38.11.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_skipSA_ignoreEgoHist_imiObj_withAgents_progress0.1_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.14.00.57.14/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.14.00.57.14.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc3_dec3_skipSA_ignoreEgoHist_imiObj_withAgents_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.12.05.58.10/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.12.05.58.10.parquet' # enc3_dec3_withAgents
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc4_dec4_skipSA_ignoreEgoHist_imiObj_withAgents_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.16.13.36.51/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.16.13.36.51.parquet'  # enc4_dec4_withAgents
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc4_dec4_skipSA_ignoreEgoHist_imiObj_withAgents_withVelacc_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.20.12.13.53/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.20.12.13.53.parquet'  # enc4_dec4_withAgents_withVelacc
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc4_dec4_skipSA_ignoreEgoHist_imiObj_withAgents_withVelaccDropout_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.21.14.34.13/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.21.14.34.13.parquet'  # enc4_dec4_withAgents_withVelaccDropout
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/base_mtra_gameoformerEnc_maxRtPtPEAsStaticQ_enc4_dec4_skipSA_ignoreEgoHist_imiObj_withAgents_noVelacc_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.23.03.44.16/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.23.03.44.16.parquet'  # enc4_dec4_withAgents_noVelacc
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.23.14.14.05/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.23.14.14.05.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_multLR_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.24.07.45.12/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.24.07.45.12.parquet'
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.27.03.44.09/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.27.03.44.09.parquet' # enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_sim30
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.27.07.40.02/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.27.07.40.02.parquet' # enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_sim100
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_perturb_ckpt18/simulation_closed_loop_nonreactive_agents/2023.09.28.15.17.51/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.28.15.17.51.parquet' # enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_perturb_sim30
# fn = '/mnt/nas20/qiang.liu/nuplan_simulation_save_dir/enc3_ignoreEgoHist_imiObj_withAgents_mlpDecoder_withGoalEmb_mtraLoss_ckpt19/simulation_closed_loop_nonreactive_agents/2023.09.30.00.59.31/aggregator_metric/closed_loop_nonreactive_agents_weighted_average_metrics_2023.09.30.00.59.31.parquet'
fn = '/mnt/nas20/qiang.liu/plantf_simulation_save_dir/state_attn_enc_off/closed_loop_nonreactive_agents/test14-random/planTF/runner_report.parquet'
df = pd.read_parquet(fn)
print(df.iloc[-1])

